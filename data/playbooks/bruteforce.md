# Bruteforce (Подбор учетных данных)

## Описание инцидента
Bruteforce — атака, направленная на подбор учетных данных путем многократных
попыток аутентификации. Может быть как самостоятельной угрозой, так и этапом
более сложных атак (Account Takeover, lateral movement).
Чаще всего нацелена на сервисы аутентификации: VPN, RDP, OWA, SSO, SaaS.

---

## Preparation (Подготовка)

- Централизованное логирование аутентификации
- Политики блокировки учетных записей
- Ограничения по количеству попыток входа
- Настроенные правила корреляции bruteforce в SIEM
- Автоматизация блокировок через SOAR / IRP

---

## Identification (Идентификация)

### Триггеры инцидента

- Multiple failed login attempts за короткий период
- Попытки входа с одного IP / ASN на множество учетных записей
- Попытки входа на одну учетную запись с множества IP
- Использование нетипичных протоколов (RDP, OWA, VPN)
- Аномалии по времени (ночные часы, выходные)

### Действия SOC

- Анализ логов аутентификации:
  - количество failed logon
  - временные интервалы
  - IP / ASN / User-Agent
  - целевые учетные записи
- Проверка IP и ASN по источникам репутации
- Определение типа атаки:
  - password spraying
  - credential stuffing
  - классический bruteforce
- Оценка успешных попыток входа

Результат:
- подтверждённый или отклонённый инцидент bruteforce
- определение масштаба атаки и критичности

---

## Containment (Локализация)

Типовые меры сдерживания:

- Временная блокировка атакуемых учетных записей
- Блокировка источников атак (IP / ASN)
- Ограничение доступа по протоколам (RDP, VPN, OWA)
- Включение дополнительных проверок (CAPTCHA, MFA)
- Ограничение скорости аутентификации (rate limiting)

Результат:
- прекращение активной фазы атаки

---

## Eradication (Устранение)

Типовые действия:

- Сброс паролей затронутых учетных записей
- Проверка повторного использования паролей
- Анализ возможных успешных входов
- Проверка связанных инцидентов (ATO, malware)
- Устранение уязвимых конфигураций:
  - слабые пароли
  - отсутствие MFA
  - устаревшие политики блокировки

Результат:
- устранены условия, позволившие атаку

---

## Recovery (Восстановление)

- Восстановление доступа пользователям после сброса паролей
- Мониторинг аутентификации после инцидента
- Подтверждение отсутствия успешной компрометации
- Актуализация политик безопасности

Результат:
- системы функционируют в штатном режиме

---

## Lessons Learned (Анализ и улучшения)

- Анализ источников и методов атаки
- Донастройка правил корреляции bruteforce
- Улучшение автоматизации реагирования:
  - авто-блокировки
  - авто-сброс паролей
- Пересмотр парольных и MFA-политик
- Обновление плейбука и базы знаний SOC

---

## Evidence to Collect

- Authentication logs
- IP / ASN reputation
- User-Agent и fingerprint
- Временные интервалы попыток входа
- Логи VPN / RDP / SSO
- История блокировок учетных записей

---

## Escalation Criteria

Инцидент подлежит эскалации при:

- Успешных попытках входа
- Массовом характере атаки
- Атаках на привилегированные учетные записи
- Повторяемости атак после блокировок
- Признаках перехода к Account Takeover
